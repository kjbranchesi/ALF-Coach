<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ALF Project Builder Test Flow</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f8fafc;
        }
        .test-section {
            background: white;
            border-radius: 8px;
            padding: 24px;
            margin-bottom: 20px;
            border-left: 4px solid #4f46e5;
        }
        .step {
            margin-bottom: 16px;
            padding: 16px;
            background: #f1f5f9;
            border-radius: 6px;
        }
        .step h3 {
            margin: 0 0 8px 0;
            color: #1e293b;
        }
        .step p {
            margin: 0;
            color: #64748b;
        }
        button {
            background: #4f46e5;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 8px 8px 8px 0;
        }
        button:hover {
            background: #4338ca;
        }
        .results {
            background: #ecfdf5;
            border: 1px solid #10b981;
            border-radius: 6px;
            padding: 16px;
            margin-top: 16px;
        }
        .error {
            background: #fef2f2;
            border: 1px solid #ef4444;
            border-radius: 6px;
            padding: 16px;
            margin-top: 16px;
        }
    </style>
</head>
<body>
    <h1>üß™ ALF Project Builder Test Flow</h1>
    <p>Testing the complete wizard ‚Üí chat ‚Üí hero project transformation pipeline</p>

    <div class="test-section">
        <h2>üìã Test Objectives</h2>
        <div class="step">
            <h3>1. Wizard Data Collection</h3>
            <p>Verify wizard creates proper project foundation</p>
        </div>
        <div class="step">
            <h3>2. Chat Interface Integration</h3>
            <p>Test ChatbotFirstInterfaceFixed.tsx with AI coaching</p>
        </div>
        <div class="step">
            <h3>3. Data Persistence</h3>
            <p>Confirm UnifiedStorageManager auto-save works</p>
        </div>
        <div class="step">
            <h3>4. Hero Project Transformation</h3>
            <p>Verify output matches 400-500 line Hero Project quality</p>
        </div>
    </div>

    <div class="test-section">
        <h2>üöÄ Test Actions</h2>

        <button onclick="startNewProject()">1. Start New Project (Wizard)</button>
        <button onclick="openChatInterface()">2. Open Chat Interface</button>
        <button onclick="checkDataPersistence()">3. Check Data Persistence</button>
        <button onclick="testHeroTransformation()">4. Test Hero Transformation</button>

        <div id="testResults"></div>
    </div>

    <div class="test-section">
        <h2>üìä Expected vs Actual Results</h2>

        <div class="step">
            <h3>Expected: 400-500 Lines of Rich Project Data</h3>
            <p>Like hero-sustainability.ts: detailed phases, assessments, scaffolding, differentiation</p>
        </div>

        <div class="step">
            <h3>Actual: [To be determined]</h3>
            <p id="actualResults">Run tests to see actual output quality</p>
        </div>
    </div>

    <script>
        let testResults = document.getElementById('testResults');
        let actualResults = document.getElementById('actualResults');

        function logResult(message, type = 'info') {
            const div = document.createElement('div');
            div.className = type === 'error' ? 'error' : 'results';
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            testResults.appendChild(div);
        }

        function startNewProject() {
            logResult('üîÑ Starting new project wizard...');

            // Open wizard in new tab
            window.open('http://localhost:5173/app/blueprint/new-project', '_blank');

            logResult('‚úÖ Wizard opened - complete the basic project setup', 'info');
            logResult('üìù Note the project ID generated for next steps', 'info');
        }

        function openChatInterface() {
            const projectId = prompt('Enter the project ID from wizard (or use test-project-123):');
            if (!projectId) {
                logResult('‚ùå Project ID required', 'error');
                return;
            }

            logResult(`üîÑ Opening chat interface for project: ${projectId}`);

            // Open chat interface
            window.open(`http://localhost:5173/app/blueprint/${projectId}`, '_blank');

            logResult('‚úÖ Chat interface opened - test the AI coaching conversation', 'info');
            logResult('üéØ Goal: Complete conversation to reach COMPLETE stage', 'info');
        }

        function checkDataPersistence() {
            logResult('üîÑ Checking localStorage for project data...');

            // Check localStorage for ALF project data
            const alfKeys = Object.keys(localStorage).filter(key =>
                key.startsWith('alf_project_') ||
                key.startsWith('alf_hero_') ||
                key.includes('blueprint')
            );

            if (alfKeys.length > 0) {
                logResult(`‚úÖ Found ${alfKeys.length} ALF storage keys: ${alfKeys.join(', ')}`, 'info');

                // Try to load and examine one project
                const projectKey = alfKeys.find(k => k.startsWith('alf_project_'));
                if (projectKey) {
                    try {
                        const data = JSON.parse(localStorage.getItem(projectKey));
                        const dataSize = JSON.stringify(data).length;
                        logResult(`üìä Project data size: ${dataSize} characters`, 'info');
                        logResult(`üìã Data structure: ${Object.keys(data).join(', ')}`, 'info');
                    } catch (e) {
                        logResult(`‚ùå Error parsing project data: ${e.message}`, 'error');
                    }
                }
            } else {
                logResult('‚ùå No ALF project data found in localStorage', 'error');
                logResult('üí° Try completing a wizard + chat flow first', 'info');
            }
        }

        function testHeroTransformation() {
            logResult('üîÑ Testing Hero Project transformation...');

            // This would need to be integrated with the actual service
            logResult('üîß Manual check required:', 'info');
            logResult('1. Open browser dev tools console', 'info');
            logResult('2. Look for: "Hero Project transformation complete" message', 'info');
            logResult('3. Check localStorage for alf_hero_ keys', 'info');
            logResult('4. Verify output size (should be 400-500 lines equivalent)', 'info');

            // Try to access transformation service from global scope
            try {
                if (window.heroProjectTransformer) {
                    logResult('‚úÖ HeroProjectTransformer found in global scope', 'info');
                } else {
                    logResult('‚ö†Ô∏è HeroProjectTransformer not found - check integration', 'error');
                }
            } catch (e) {
                logResult(`üîß Cannot access transformer from test context: ${e.message}`, 'info');
            }
        }

        // Auto-check data persistence on load
        setTimeout(checkDataPersistence, 1000);
    </script>
</body>
</html>